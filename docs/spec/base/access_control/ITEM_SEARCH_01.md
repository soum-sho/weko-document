# 検索画面

検索画面のアクセスコントロールについて記述します。

エンドポイント：（/search）

## 目次

- [簡易検索](#簡易検索)
- [詳細検索](#詳細検索)
- [ファセット検索](#ファセット検索)
- [インデックス閲覧権限](#インデックス閲覧権限)

## 簡易検索

インデックスの閲覧権限があるかどうかと、アイテムの公開日および公開ステータスの組み合わせによって、検索結果に表示されるかどうかが決まります。

#### ① インデックス閲覧権限がある場合

以下の条件1,2のどちらかが○なら検索結果に表示され、両方×なら表示されません。

| 条件1 /ロール                             | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ----------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 公開日以降かつ<br>公開ステータス：Publish | ○                  | ○                    | ○                      | ○            | ○            | ○                        |
| 上記を満たさない                          | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

| 条件2 /ロール                    | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者※1 | 登録ユーザー※1 | 一般ユーザー※2 | ゲスト<br>（未ログイン） |
| -------------------------------- | ------------------ | -------------------- | ------------------------ | -------------- | -------------- | ------------------------ |
| 作成者または<br>代理投稿者が自身 | ○                  | ○                    | ○                        | ○              | ×              | ×                        |
| 上記を満たさない                 | ○                  | ○                    | ×                        | ×              | ×              | ×                        |

#### ② インデックス閲覧権限がある場合

以下の条件1,2のどちらかが○なら検索結果に表示され、両方×なら表示されません。

| 条件1 /ロール                             | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ----------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 公開日以降かつ<br>公開ステータス：Publish | ○                  | ○                    | ×                      | ×            | ×            | ×                        |
| 上記を満たさない                          | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

| 条件2 /ロール                    | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者※1 | 登録ユーザー※1 | 一般ユーザー※2 | ゲスト<br>（未ログイン） |
| -------------------------------- | ------------------ | -------------------- | ------------------------ | -------------- | -------------- | ------------------------ |
| 作成者または<br>代理投稿者が自身 | ○                  | ○                    | ×                        | ×              | ×              | ×                        |
| 上記を満たさない                 | ○                  | ○                    | ×                        | ×              | ×              | ×                        |

※1 厳密には管理画面のユーザー管理 > アクセス: ロールでsearch-accessのActionが与えられたロールを指します。

※2 厳密には管理画面のユーザー管理 > アクセス: ロールでsearch-accessのActionが与えられていないロールを指します。

※ インデックス投稿権限については [インデックス閲覧権限](#インデックス閲覧権限)を参照してください。

## 詳細検索

インデックスの閲覧権限があるかどうかと、アイテムの公開日および公開ステータスの組み合わせによって、検索結果に表示されるかどうかが決まります。

#### ① インデックス閲覧権限がある場合

以下の条件1,2のどちらかが○なら検索結果に表示され、両方×なら表示されません。

| 条件1 /ロール                             | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ----------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 公開日以降かつ<br>公開ステータス：Publish | ○                  | ○                    | ○                      | ○            | ○            | ○                        |
| 上記を満たさない                          | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

| 条件2 /ロール                    | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者※1 | 登録ユーザー※1 | 一般ユーザー※2 | ゲスト<br>（未ログイン） |
| -------------------------------- | ------------------ | -------------------- | ------------------------ | -------------- | -------------- | ------------------------ |
| 作成者または<br>代理投稿者が自身 | ○                  | ○                    | ○                        | ○              | ×              | ×                        |
| 上記を満たさない                 | ○                  | ○                    | ×                        | ×              | ×              | ×                        |

#### ② インデックス閲覧権限がある場合

以下の条件1,2のどちらかが○なら検索結果に表示され、両方×なら表示されません。

| 条件1 /ロール                             | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ----------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 公開日以降かつ<br>公開ステータス：Publish | ○                  | ○                    | ×                      | ×            | ×            | ×                        |
| 上記を満たさない                          | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

| 条件2 /ロール                    | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者※1 | 登録ユーザー※1 | 一般ユーザー※2 | ゲスト<br>（未ログイン） |
| -------------------------------- | ------------------ | -------------------- | ------------------------ | -------------- | -------------- | ------------------------ |
| 作成者または<br>代理投稿者が自身 | ○                  | ○                    | ×                        | ×              | ×              | ×                        |
| 上記を満たさない                 | ○                  | ○                    | ×                        | ×              | ×              | ×                        |

※1 厳密には管理画面のユーザー管理 > アクセス: ロールでsearch-accessのActionが与えられたロールを指します。

※2 厳密には管理画面のユーザー管理 > アクセス: ロールでsearch-accessのActionが与えられていないロールを指します。

※ インデックス投稿権限については [インデックス閲覧権限](#インデックス閲覧権限)を参照してください。

## ファセット検索

インデックスの閲覧権限があるかどうかと、アイテムの公開日および公開ステータスの組み合わせによって、検索結果に表示されるかどうかが決まります。

#### ① インデックス閲覧権限がある場合

以下の条件1,2のどちらかが○なら検索結果に表示され、両方×なら表示されません。

| 条件1 /ロール                             | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ----------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 公開日以降かつ<br>公開ステータス：Publish | ○                  | ○                    | ○                      | ○            | ○            | ○                        |
| 上記を満たさない                          | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

| 条件2 /ロール                    | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者※1 | 登録ユーザー※1 | 一般ユーザー※2 | ゲスト<br>（未ログイン） |
| -------------------------------- | ------------------ | -------------------- | ------------------------ | -------------- | -------------- | ------------------------ |
| 作成者または<br>代理投稿者が自身 | ○                  | ○                    | ○                        | ○              | ×              | ×                        |
| 上記を満たさない                 | ○                  | ○                    | ×                        | ×              | ×              | ×                        |

#### ② インデックス閲覧権限がある場合

以下の条件1,2のどちらかが○なら検索結果に表示され、両方×なら表示されません。

| 条件1 /ロール                             | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ----------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 公開日以降かつ<br>公開ステータス：Publish | ○                  | ○                    | ×                      | ×            | ×            | ×                        |
| 上記を満たさない                          | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

| 条件2 /ロール                    | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者※1 | 登録ユーザー※1 | 一般ユーザー※2 | ゲスト<br>（未ログイン） |
| -------------------------------- | ------------------ | -------------------- | ------------------------ | -------------- | -------------- | ------------------------ |
| 作成者または<br>代理投稿者が自身 | ○                  | ○                    | ×                        | ×              | ×              | ×                        |
| 上記を満たさない                 | ○                  | ○                    | ×                        | ×              | ×              | ×                        |

※1 厳密には管理画面のユーザー管理 > アクセス: ロールでsearch-accessのActionが与えられたロールを指します。

※2 厳密には管理画面のユーザー管理 > アクセス: ロールでsearch-accessのActionが与えられていないロールを指します。

※ インデックス投稿権限については [インデックス閲覧権限](#インデックス閲覧権限)を参照してください。

## インデックス閲覧権限

インデックスへの閲覧権限を利用するには条件1～4のすべてを満たす必要があります。

一つでも×があれば閲覧不可、すべて○であれば閲覧が可能です。

条件1 インデックス公開ステータス

| 条件/ロール | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者<br>（対象：自身が<br>管理する<br>インデックス※1） | コミュニティ<br>管理者<br>（対象：自身が<br>管理しない<br>インデックス） | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ----------- | ------------------ | -------------------- | ------------------------------------------------------------------------ | ------------------------------------------------------------------------ | ------------ | ------------ | ------------------------ |
| 公開        | ○                  | ○                    | ○                                                                        | ○                                                                        | ○            | ○            | ○                        |
| 非公開      | ○                  | ○                    | ○                                                                        | ×                                                                        | ×            | ×            | ×                        |

条件2 公開日前/後

| 条件/ロール                                | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者<br>（対象：自身が<br>管理する<br>インデックス※1） | コミュニティ<br>管理者<br>（対象：自身が<br>管理しない<br>インデックス） | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ------------------------------------------ | ------------------ | -------------------- | ------------------------------------------------------------------------ | ------------------------------------------------------------------------ | ------------ | ------------ | ------------------------ |
| 公開前                                     | ○                  | ○                    | ○                                                                        | ×                                                                        | ×            | ×            | ×                        |
| 公開後、<br>または<br>公開日：<br>指定なし | ○                  | ○                    | ○                                                                        | ○                                                                        | ○            | ○            | ○                        |

条件3 親インデックス閲覧可否

| 条件/ロール | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者<br>（対象：自身が<br>管理する<br>インデックス※1） | コミュニティ<br>管理者<br>（対象：自身が<br>管理しない<br>インデックス） | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ----------- | ------------------ | -------------------- | ------------------------------------------------------------------------ | ------------------------------------------------------------------------ | ------------ | ------------ | ------------------------ |
| 可          | ○                  | ○                    | ○                                                                        | ○                                                                        | ○            | ○            | ○                        |
| 不可        | ○                  | ○                    | ○                                                                        | ×                                                                        | ×            | ×            | ×                        |

※1： 自身が管理するインデックスとは、当該コミュニティ管理者が管理するコミュニティの「Index」に指定されているインデックスとその子インデックスを指します。

条件4 ユーザーの持つロールがすべて「権限あり」に設定されている、またはユーザーの持つグループの1個以上が「権限あり」に設定されている ※2

| 条件/ロール          | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者<br>（対象：自身が<br>管理する<br>インデックス※1） | コミュニティ<br>管理者<br>（対象：自身が<br>管理しない<br>インデックス） | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------------------- | ------------------ | -------------------- | ------------------------------------------------------------------------ | ------------------------------------------------------------------------ | ------------ | ------------ | ------------------------ |
| 設定されて<br>いる   | ○                  | ○                    | ○                                                                        | ○                                                                        | ○            | ○            | ○                        |
| 設定されて<br>いない | ○                  | ○                    | ○                                                                        | ×                                                                        | ×            | ×            | ×                        |

※1 自身が管理するインデックスとは、当該コミュニティ管理者が管理するコミュニティの「Index」に指定されているインデックスとその子インデックスを指します。

※2 「権限あり」とは、管理画面のインデックスツリー管理 ＞ ツリー編集 でインデックスごとに設定出来る「投稿権限」の値です。

- > 更新履歴

<table>
<thead>
<tr class="header">
<th>日付</th>
<th>GitHubコミットID</th>
<th>更新内容</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><blockquote>
<p>2025/8/4</p>
</blockquote></td>
<td></td>
<td>初版作成</td>
</tr>
</tbody>
</table>
