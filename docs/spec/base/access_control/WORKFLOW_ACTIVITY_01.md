# ワークフローアクティビティ

ワークフローアクティビティのアクセスコントロールについて記述します。

エンドポイント：　/workflow/

## 目次

- [ワークフロー](#ワークフロー)
  - [ToDoタブ](#ToDoタブ)
  - [Waitタブ](#Waitタブ)
  - [Allタブ](#Allタブ)
- [アクティビティ](#アクティビティ)
  - [新規アクティビティ](#新規アクティビティ)
  - [ItemRegistration](#ItemRegistration)
  - [ItemLink](#ItemLink)
  - [IdentifierGrant](#IdentifierGrant)
  - [Approval](#Approval)

#### ワークフロー

| ロール         | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| ページ閲覧可否 | ○                  | ○                    | ○                      | ○            | ×            | ×                        |

### アクティビティタブ

タブはToDoタブ、Waitタブ、All（全て）タブの3種類です。

いずれかの○に合致すればタブにアクティビティが表示されます。

また、表示内容はユーザーのロールとアクティビティの状態（作成中・編集中・承認待ちなど）によって動的に変化します。

##### ToDoタブ

エンドポイント：/workflow/?tab=todo

アクティビティの状態：新規アイテム作成中 / 投稿先インデックスが所属コミュニティに登録：あり

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ○                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

アクティビティの状態：新規アイテム作成中 / 投稿先インデックスが所属コミュニティに登録：なし

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ×                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

アクティビティの状態：既存アイテム編集中 / 投稿先インデックスが所属コミュニティに登録：あり

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ○                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

アクティビティの状態：既存アイテム編集中 / 投稿先インデックスが所属コミュニティに登録：なし

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ×                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

アクティビティの状態：承認待ち / 投稿先インデックスが所属コミュニティに登録：あり

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ×                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

アクティビティの状態：承認待ち / 投稿先インデックスが所属コミュニティに登録：なし

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ×                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

##### Waitタブ

エンドポイント：/workflow/?tab=wait

アクティビティの状態：承認待ち / 投稿先インデックスが所属コミュニティに登録：あり

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ○                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

アクティビティの状態：承認待ち / 投稿先インデックスが所属コミュニティに登録：なし

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ×                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

##### Allタブ

エンドポイント：/workflow/?tab=all

アクティビティの状態：新規アイテム作成中 / 投稿先インデックスが所属コミュニティに登録：あり

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ○                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ○                      | ×            | ×            | ×                        |

アクティビティの状態：新規アイテム作成中 / 投稿先インデックスが所属コミュニティに登録：なし

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ×                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

アクティビティの状態：既存アイテム編集中 / 投稿先インデックスが所属コミュニティに登録：あり

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ○                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ○                      | ×            | ×            | ×                        |

アクティビティの状態：既存アイテム編集中 / 投稿先インデックスが所属コミュニティに登録：なし

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ×                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

アクティビティの状態：承認待ち / 投稿先インデックスが所属コミュニティに登録：あり

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ○                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ○                      | ×            | ×            | ×                        |

アクティビティの状態：承認待ち / 投稿先インデックスが所属コミュニティに登録：なし

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ×                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

アクティビティの状態：承認済み・強制終了 / 投稿先インデックスが所属コミュニティに登録：あり

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ○                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ○                      | ×            | ×            | ×                        |

アクティビティの状態：承認済み・強制終了 / 投稿先インデックスが所属コミュニティに登録：なし

| 条件/ロール                        | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| アクティビティ操作者：<br>自分     | ○                  | ○                    | ×                      | ○            | ×            | ×                        |
| アクティビティ操作者：<br>自分以外 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

### アクティビティ

エンドポイント：/workflow/activity

アクティビティの閲覧はユーザーのロールとアクセス元によって変化します。

いずれかの○に合致すればタブにアクティビティを閲覧出来ます。

---

アクセス元：ToDoタブ / アイテム登録済みインデックス閲覧権限：条件なし

| ロール         | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| ページ閲覧可否 | ○                  | ○                    | ○                      | ○            | ×            | ×                        |

アクセス元：アイテム詳細画面 > [編集]ボタン / アイテム登録済みインデックス閲覧権限：あり

| 条件/ロール      | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 作成者：自分     | ○                  | ○                    | ○                      | ○            | ×            | ×                        |
| 代理投稿者：自分 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |
| 上記以外         | ○                  | ○                    | ○                      | ×            | ×            | ×                        |

アクセス元：アイテム詳細画面 > [編集]ボタン / アイテム登録済みインデックス閲覧権限：なし

| 条件/ロール      | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 作成者：自分     | ○                  | ○                    | ×                      | ×            | ×            | ×                        |
| 代理投稿者：自分 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |
| 上記以外         | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

#### 新規アクティビティ

エンドポイント：/workflow/activity/new

| ロール           | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| ページの閲覧可否 | ○                  | ○                    | ○                      | ○            | ○※1          | ×                        |

※1：URL入力で直接アクセスすることで閲覧可能

管理画面 ワークフロー管理 ＞ ワークフローの表示/非表示欄でユーザーの持つロールが「表示」に登録されている

| ロール           | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| ワークフロー表示 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |

管理画面 ワークフロー管理 ＞ ワークフローの表示/非表示欄でユーザーの持つロールが「表示」に登録されていない

| ロール           | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| ワークフロー表示 | ×                  | ×                    | ×                      | ×            | ×            | ×                        |

#### ItemRegistration

エンドポイント：/workflow/activity/detail/

新規作成

| ロール         | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| ページ閲覧可否 | ○                  | ○                    | ○                      | ○            | ×            | ×                        |

編集

| 条件/ロール      | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 作成者：自分     | ○                  | ○                    | ○                      | ○            | ×            | ×                        |
| 代理投稿者：自分 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |
| 上記以外         | ○                  | ○                    | ○                      | ×            | ×            | ×                        |

メタデータ入力

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |

ファイルアップロード

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |

代理投稿者指定

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |

フィードバックメール指定

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |

CRIS機関への自動連携

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |

リクエストメール表示機能

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |

バージョン変更

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |

投稿インデックス指定機能

| 条件/ロール                    | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ------------------------------ | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| インデックス投稿権限：<br>あり | ○                  | ○                    | ○                      | ○            | ○            | ×                        |
| インデックス投稿権限：<br>なし | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

#### ItemLink

エンドポイント：/workflow/activity/detail/

アイテムリンクの登録

| 条件/ロール                  | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| インデックス公開：<br>公開   | ○                  | ○                    | ○                      | ○            | ○            | ×                        |
| インデックス公開：<br>非公開 | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

#### IdentifierGrant

エンドポイント：/workflow/activity/detail/

DOIの付与・取り下げ

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |

※一度DOIを取り下げしたアイテムは再度DOIを付与することは出来ません。

#### Approval

エンドポイント：/workflow/activity/detail/

アイテム承認可否

| 条件/ロール      | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 作成者：自分     | ○                  | ○                    | ○                      | ×            | ×            | ×                        |
| 代理投稿者：自分 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |

ファイルプレビュー

| 条件/ロール      | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 作成者：自分     | ○                  | ○                    | ○                      | ○            | ×            | ×                        |
| 代理投稿者：自分 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |
| 上記以外         | ○                  | ○                    | ○                      | ×            | ×            | ×                        |

制限公開フラグありの承認可否

| 条件/ロール      | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 作成者：自分     | ○                  | ○                    | ○                      | ×※1          | × ※1         | ×                        |
| 代理投稿者：自分 | ○                  | ○                    | ○                      | ○            | ○            | ×                        |
| 上記以外         | ○                  | ○                    | ○                      | ×            | ×            | ×                        |

※1： 「トップページに戻る」のリンクが表示されます。

- > 更新履歴

<table>
<thead>
<tr class="header">
<th>日付</th>
<th>GitHubコミットID</th>
<th>更新内容</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><blockquote>
<p>2025/8/1</p>
</blockquote></td>
<td></td>
<td>初版作成</td>
</tr>
</tbody>
</table>
