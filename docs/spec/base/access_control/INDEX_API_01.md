# インデックス

インデックスに関するAPIのアクセスコントロールについて記述します。

## 目次

- [全インデックス取得](#全インデックス取得)
- [インデックス取得](#インデックス取得)
- [インデックス登録](#インデックス登録)
- [インデックス更新](#インデックス更新)
- [インデックス削除](#インデックス削除)

## 全インデックス取得

エンドポイント：[GET] /api/<version>/tree , [GET] /api/<version>/tree/<index_id>

いずれかの○に合致すれば、全インデックスを取得することが出来ます。

| 条件/ロール                                  | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| トークンのスコープに<br>index:read<br>がある | ○                  | ○                    | ○                      | ○            | ○            | ー                       |
| 上記以外                                     | ×                  | ×                    | ×                      | ×            | ×            | ×                        |

※ インデックスの閲覧可否は画面からのアクセス(/search?&search_type=2&q=0)と同条件です。<br>
　[インデックス閲覧権限](ITEM_SEARCH_01.md#インデックス閲覧権限)を参照ください。

## インデックス取得

エンドポイント：[GET] /api/<version>/tree/index , [GET] /api/<version>/tree/index/<index_id> , [GET] /api/<version>/tree/index/<index_id>/parent

いずれかの○に合致すれば、インデックスを取得することが出来ます。

| 条件/ロール                                  | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| トークンのスコープに<br>index:read<br>がある | ○                  | ○                    | ○                      | ○            | ○            | ー                       |
| 上記以外                                     | ×                  | ×                    | ×                      | ×            | ×            | ○                        |

※ インデックスの閲覧可否は画面からのアクセス(/search?&search_type=2&q=0)と同条件です。<br>
　[インデックス閲覧権限](ITEM_SEARCH_01.md#インデックス閲覧権限)を参照ください。

## インデックス登録

エンドポイント：[POST] /api/<version>/tree/index

インデックス登録APIを使用するためには2つの条件を満たす必要があります。

一つでも×なら不可、すべて○であればインデックスを登録することが出来ます。

条件1 作成するインデックスの親

| 条件1/ロール                     | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 自身の管理する<br>インデックス   | ○                  | ○                    | ○                      | ×            | ×            | ×                        |
| 自身の管理しない<br>インデックス | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

条件2 トークンのスコープ

| 条件2/ロール           | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| index:create<br>がある | ○                  | ○                    | ○                      | ×            | ×            | ×                        |
| 上記以外               | ×                  | ×                    | ×                      | ×            | ×            | ×                        |

## インデックス更新

エンドポイント：[PUT] /api/<version>/tree/index/<index_id>

インデックス更新APIを使用するためには2つの条件を満たす必要があります。

一つでも×なら不可、すべて○であればインデックスを更新することが出来ます。

条件1 作成するインデックスの親

| 条件1/ロール                     | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 自身の管理する<br>インデックス   | ○                  | ○                    | ○                      | ×            | ×            | ×                        |
| 自身の管理しない<br>インデックス | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

条件2 トークンのスコープ

| 条件2/ロール           | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| index:update<br>がある | ○                  | ○                    | ○                      | ×            | ×            | ×                        |
| 上記以外               | ×                  | ×                    | ×                      | ×            | ×            | ×                        |

## インデックス削除

エンドポイント：[DELETE] /api/<version>/tree/index/<index_id>

インデックス削除APIを使用するためには2つの条件を満たす必要があります。

一つでも×なら不可、すべて○であればインデックスを削除することが出来ます。

条件1 自身の管理するインデックスか否か

| 条件1/ロール                     | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 自身の管理する<br>インデックス   | ○                  | ○                    | ○                      | ×            | ×            | ×                        |
| 自身の管理しない<br>インデックス | ○                  | ○                    | ×                      | ×            | ×            | ×                        |

条件2 トークンのスコープ

| 条件2/ロール           | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| index:delete<br>がある | ○                  | ○                    | ○                      | ×            | ×            | ×                        |
| 上記以外               | ×                  | ×                    | ×                      | ×            | ×            | ×                        |

- > 更新履歴

<table>
<thead>
<tr class="header">
<th>日付</th>
<th>GitHubコミットID</th>
<th>更新内容</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><blockquote>
<p>2025/8/5</p>
</blockquote></td>
<td></td>
<td>初版作成</td>
</tr>
</tbody>
</table>
