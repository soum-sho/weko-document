# ファイル

ファイルに関するAPIのアクセスコントロールについて記述します。

## 目次

- [ファイルランキング情報取得](#ファイルランキング情報取得)
- [ファイル取得](#ファイル取得)
- [レコード統計取得](#レコード統計取得)
- [全ファイル一覧情報取得](#全ファイル一覧情報取得)
- [指定レコードの選択ファイル一覧取得](#指定レコードの選択ファイル一覧取得)
- [ランキング情報取得](#ランキング情報取得)

## ファイルランキング情報取得

エンドポイント：[GET] /api/<version>/ranking/<pid_value>/files

いずれかの○に合致すれば、APIでファイルのランキング情報を取得することが出来ます。

#### インデックス閲覧権限：あり

| 条件/ロール                                    | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| トークンのスコープに<br>ranking:read<br>がある | ○                  | ○                    | ○                      | ○            | ○            | ×                        |
| 上記以外                                       | ×                  | ×                    | ×                      | ×            | ×            | ○                        |

#### インデックス閲覧権限：なし

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ー                 | ー                   | ×                      | ×            | ×            | ×                        |

## ファイル取得

エンドポイント：[GET] /api/<version>/records/<pid_value>/files/<filename>

いずれかの○に合致すれば、ファイルを取得することが出来ます。

#### インデックス閲覧権限：あり

| 条件/ロール                                 | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ------------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| トークンのスコープに<br>user:read<br>がある | ○                  | ○                    | ○                      | ○            | ○            | ×                        |
| 上記以外                                    | ×                  | ×                    | ×                      | ×            | ×            | ○                        |

#### インデックス閲覧権限：なし

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ー                 | ー                   | ×                      | ×            | ×            | ×                        |

## レコード統計取得

エンドポイント：[GET] /api/<version>/records/<pid_value>/files/<filename>/stats

いずれかの○に合致すれば、レコード統計を取得することが出来ます。

#### インデックス閲覧権限：あり

| 条件/ロール                                 | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ------------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| トークンのスコープに<br>file:read<br>がある | ○                  | ○                    | ○                      | ○            | ○            | ×                        |
| 上記以外                                    | ×                  | ×                    | ×                      | ×            | ×            | ○                        |

#### インデックス閲覧権限：なし

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ー                 | ー                   | ×                      | ×            | ×            | ×                        |

## 全ファイル一覧情報取得

エンドポイント：[GET] /api/<version>/records/<pid_value>/files/all

いずれかの○に合致すれば、全ファイルの一覧情報を取得することが出来ます。

#### インデックス閲覧権限：あり

| 条件/ロール                                 | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ------------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| トークンのスコープに<br>file:read<br>がある | ○                  | ○                    | ○                      | ○            | ○            | ×                        |
| 上記以外                                    | ×                  | ×                    | ×                      | ×            | ×            | ○                        |

#### インデックス閲覧権限：なし

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ー                 | ー                   | ×                      | ×            | ×            | ×                        |

## 指定レコードの選択ファイル一覧取得

エンドポイント：[POST] /api/<version>/records/<pid_value>/files/selected

いずれかの○に合致すれば、指定レコードの選択ファイルの一覧を取得することが出来ます。

#### インデックス閲覧権限：あり

| 条件/ロール                                 | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ------------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| トークンのスコープに<br>file:read<br>がある | ○                  | ○                    | ○                      | ○            | ○            | ×                        |
| 上記以外                                    | ×                  | ×                    | ×                      | ×            | ×            | ○                        |

#### インデックス閲覧権限：なし

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ー                 | ー                   | ×                      | ×            | ×            | ×                        |

## ランキング情報取得

エンドポイント：[GET] /api/<version>/ranking/<ranking_type>

いずれかの○に合致すれば、ランキング情報を取得することが出来ます。

#### インデックス閲覧権限：あり

| 条件/ロール                                    | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| ---------------------------------------------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| トークンのスコープに<br>ranking:read<br>がある | ○                  | ○                    | ○                      | ○            | ○            | ×                        |
| 上記以外                                       | ×                  | ×                    | ×                      | ×            | ×            | ○                        |

#### インデックス閲覧権限：なし

| ロール   | システム<br>管理者 | リポジトリ<br>管理者 | コミュニティ<br>管理者 | 登録ユーザー | 一般ユーザー | ゲスト<br>（未ログイン） |
| -------- | ------------------ | -------------------- | ---------------------- | ------------ | ------------ | ------------------------ |
| 利用可否 | ー                 | ー                   | ×                      | ×            | ×            | ×                        |

- > 更新履歴

<table>
<thead>
<tr class="header">
<th>日付</th>
<th>GitHubコミットID</th>
<th>更新内容</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><blockquote>
<p>2025/8/5</p>
</blockquote></td>
<td></td>
<td>初版作成</td>
</tr>
</tbody>
</table>
